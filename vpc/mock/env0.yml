version: 2

deploy:
  onSuccess:
    - name: "Update env0 project variable"
      run: ./update_variable.sh
  
  steps:
    setupVariables:
      after:
       - name: "Pre Update: Check AWS CLI Version"
         run: |
           awsv2 --version
           apk info -vv | grep -i aws
       - name: "Update latest AWS CLI"
         run: |
           su -
           curl -sL https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip -o awscliv2.zip
           unzip -q awscliv2.zip
           ./aws/install -i /usr/local/aws-cli-v2 -b /usr/local/bin/aws-cli-v2
    terraformPlan:
      after:
       - name: "Post Update: Check AWS CLI Version"
         run: |
           awsv2 --version


#deploy:
#  onSuccess:
#    - echo "Update env0 project variable"
#    - ./update_variable.sh
